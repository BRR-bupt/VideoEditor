<template>
  <div class="card">
    <div style="display: flex">
      <sp-progress-bar :value="progress1" style="width: 30%; margin: auto"> STEP (1/3) </sp-progress-bar>
      <sp-progress-bar :value="progress2" style="width: 30%; margin: auto"> STEP (2/3) </sp-progress-bar>
      <sp-progress-bar :value="progress3" style="width: 30%; margin: auto"> STEP (3/3) </sp-progress-bar>
    </div>

    <div style="display: flex">
      <sp-inline-alert v-if="showWarn" type="negative" class="inline-alert">
        <template #header>Warning</template>
        Do not change the tab until the rendering is complete.
      </sp-inline-alert>
      <sp-inline-alert v-if="end" type="success" class="inline-alert">
        <template #header>Success</template>
        Rendering Completed !
      </sp-inline-alert>
      <sp-inline-alert v-if="!isSupportBrowser" type="error" class="inline-alert">
        <template #header>Error</template>
        Sorry Your Browser Not Supported Export
      </sp-inline-alert>
    </div>
  </div>
</template>

<style scoped>
.inline-alert {
  margin: 23px auto 0;
}
</style>

<script lang="ts">
import Vue from 'vue'
import { Component, Prop } from 'vue-property-decorator'
import Progress from '../components/widget/Progress.vue'
import { isSupportBrowser } from '../plugins/browser'

@Component({
  components: {
    Progress
  }
})
export default class ExportingCard extends Vue {
  @Prop() ffmpegProgress: number = 0
  @Prop() ffmpegProgressPreparation: number = 0
  @Prop() ccaptureProgress: number = 0
  @Prop() isEncoding: boolean = false

  get end() {
    return this.ffmpegProgress >= 1 && this.ccaptureProgress >= 1
  }

  get isSupportBrowser() {
    return isSupportBrowser()
  }

  get progress1() {
    return Math.round(this.ccaptureProgress * 100)
  }

  get progress2() {
    return Math.round(this.ffmpegProgressPreparation * 100)
  }

  get progress3() {
    return Math.round(this.ffmpegProgress * 100)
  }

  get inProgress() {
    return this.ccaptureProgress > 0
  }

  get showWarn() {
    return !this.end && this.inProgress
  }

  // close() {
  //   this.$emit('close')
  // }

  // start() {
  //   this.$emit('start')
  // }

  // download() {
  //   this.$emit('download')
  // }
}
</script>
